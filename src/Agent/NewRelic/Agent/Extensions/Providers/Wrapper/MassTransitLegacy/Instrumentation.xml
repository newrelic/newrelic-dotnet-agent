<?xml version="1.0" encoding="utf-8" ?>
<!--
Copyright 2020 New Relic Corporation. All rights reserved.
SPDX-License-Identifier: Apache-2.0
-->
<extension xmlns="urn:newrelic-extension">

  <instrumentation>

    <tracerFactory name="TransportConfigLegacyWrapper">

<!--See https://github.com/MassTransit/MassTransit/compare/v7.0.7...v7.1 for changes between 7.0.7 and 7.1.0-->

      <!--TransportRegistrationBusFactory became a generic type with one type parameter between 7.0.7 and 7.1.0 -->
      <match assemblyName="MassTransit" className="MassTransit.Registration.TransportRegistrationBusFactory" minVersion="7.0.0" maxVersion="7.1.0">
        <exactMethodMatcher methodName="CreateBus" />
      </match>
      <match assemblyName="MassTransit" className="MassTransit.Registration.TransportRegistrationBusFactory`1" minVersion="7.1.0" maxVersion="8.0.0">
        <exactMethodMatcher methodName="CreateBus" />
      </match>

      <!--The number and types of parameters to the Build method changed between 7.0.7 and 7.1.0-->
      <match assemblyName="MassTransit" className="MassTransit.BusFactoryExtensions" minVersion="7.0.0" maxVersion="7.1.0">
        <exactMethodMatcher methodName="Build" parameters="MassTransit.IBusFactory,System.Collections.Generic.IEnumerable`1[GreenPipes.ISpecification]" />
      </match>

      <match assemblyName="MassTransit" className="MassTransit.BusFactoryExtensions" minVersion="7.1.0" maxVersion="8.0.0">
        <exactMethodMatcher methodName="Build" parameters="MassTransit.IBusFactory,MassTransit.Configuration.IBusConfiguration,System.Collections.Generic.IEnumerable`1[GreenPipes.ValidationResult]" />
      </match>
    </tracerFactory>

  </instrumentation>
</extension>
