<?xml version="1.0" encoding="utf-8"?>
<!--
Copyright 2020 New Relic Corporation. All rights reserved.
SPDX-License-Identifier: Apache-2.0
-->
<extension xmlns="urn:newrelic-extension">
	<instrumentation>

		<tracerFactory name="Couchbase3CollectionWrapper">
			<match assemblyName="Couchbase.NetClient" className="Couchbase.KeyValue.CouchbaseCollection" minVersion="3.0.0.0">
        <!-- ICouchbaseCollection methods -->
				<exactMethodMatcher methodName="ExistsAsync"/>
        <exactMethodMatcher methodName="GetAllReplicasAsync"/>
        <exactMethodMatcher methodName="GetAndLockAsync"/>
        <exactMethodMatcher methodName="GetAndTouchAsync"/>
        <exactMethodMatcher methodName="GetAnyReplicaAsync"/>
				<exactMethodMatcher methodName="GetAsync"/>
				<exactMethodMatcher methodName="InsertAsync"/>
        <exactMethodMatcher methodName="LookupInAllReplicasAsync"/>
        <exactMethodMatcher methodName="LookupInAnyReplicaAsync"/>
        <exactMethodMatcher methodName="LookupInAsync"/>
        <exactMethodMatcher methodName="MutateInAsync"/>
        <exactMethodMatcher methodName="RemoveAsync"/>
        <exactMethodMatcher methodName="ReplaceAsync"/>
        <exactMethodMatcher methodName="ScanAsync"/>
        <exactMethodMatcher methodName="TouchAsync"/>
        <exactMethodMatcher methodName="TouchWithCasAsync"/>
        <exactMethodMatcher methodName="UnlockAsync"/>
        <exactMethodMatcher methodName="UpsertAsync"/>

        <!-- IBinaryCollection methods -->
        <exactMethodMatcher methodName="AppendAsync"/>
        <exactMethodMatcher methodName="PrependAsync"/>
        <exactMethodMatcher methodName="IncrementAsync"/>
        <exactMethodMatcher methodName="DecrementAsync"/>
      </match>
		</tracerFactory>

    <tracerFactory name ="Couchbase3QueryWrapper">
      <match assemblyName="Couchbase.NetClient" className="Couchbase.KeyValue.Scope" minVersion="3.0.0.0">
        <!-- IScope methods -->
        <exactMethodMatcher methodName="AnalyticsQueryAsync"/>
        <exactMethodMatcher methodName="QueryAsync"/>
        <exactMethodMatcher methodName="SearchAsync"/>
      </match>
      <match assemblyName="Couchbase.NetClient" className="Couchbase.Cluster" minVersion="3.0.0.0">
        <!-- ICluster methods -->
        <exactMethodMatcher methodName="AnalyticsQueryAsync"/>
        <exactMethodMatcher methodName="QueryAsync"/>
        <exactMethodMatcher methodName="SearchAsync"/>
        <exactMethodMatcher methodName="SearchQueryAsync"/>
      </match>
    </tracerFactory>
  </instrumentation>
</extension>
